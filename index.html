<div class="stats-box">
    <div class="grid-stats">
        <div class="g-item"><span id="accuracy-pct" class="g-val" style="color:#2ecc71">0%</span><span class="g-lbl">PREDICTION ACCURACY</span></div>
        <div class="g-item"><span id="correct-preds" class="g-val">0</span><span class="g-lbl">CORRECT</span></div>
        <div class="g-item"><span id="wrong-preds" class="g-val">0</span><span class="g-lbl">WRONG</span></div>
    </div>
    <div id="prediction-log" style="font-size: 12px; color: #f1c40f; margin-top: 5px;">Waiting for first spin...</div>
</div>

<script>
    let correctCount = 0;
    let wrongCount = 0;
    let lastPrediction = null;

    function getPrediction() {
        if (history.length < 3) return null;
        
        let last3 = history.slice(0, 3).reverse().join(''); // Last 3 results color sequence
        // R = Red, B = Black
        let seq = history.slice(0, 3).map(n => reds.includes(n) ? 'R' : 'B').reverse().join('');

        if (seq === 'RBB') return 'RED'; // Expecting 123 pattern continuation
        if (seq === 'RRB') return 'BLACK'; // Expecting Group March switch
        if (seq === 'RBR') return 'BLACK'; // Expecting Zigzag
        return Math.random() > 0.5 ? 'RED' : 'BLACK'; // Random if no pattern
    }

    // Isse executeSpin() ke onfinish ke andar updateData() se pehle bulayein
    function checkAccuracy(currentWinNum) {
        if (lastPrediction === null) {
            lastPrediction = getPrediction();
            return;
        }

        let actualColor = reds.includes(currentWinNum) ? 'RED' : (currentWinNum === 0 ? 'ZERO' : 'BLACK');
        
        if (actualColor === lastPrediction) {
            correctCount++;
            document.getElementById('prediction-log').innerText = `✅ Last Prediction (${lastPrediction}) was CORRECT!`;
        } else {
            wrongCount++;
            document.getElementById('prediction-log').innerText = `❌ Last Prediction (${lastPrediction}) was WRONG (Landed: ${actualColor})`;
        }

        // Update UI
        let totalPreds = correctCount + wrongCount;
        let accuracy = Math.round((correctCount / totalPreds) * 100);
        document.getElementById('accuracy-pct').innerText = accuracy + "%";
        document.getElementById('correct-preds').innerText = correctCount;
        document.getElementById('wrong-preds').innerText = wrongCount;

        // Set next prediction
        lastPrediction = getPrediction();
    }
</script>
